<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Graphical and Latent Variable Modeling</title>
  <meta name="description" content="This document focuses on structural equation modeling. It is conceptually based, and tries to generalize beyond the standard SEM treatment. It includes special emphasis on the lavaan package. Topics include: graphical models, including path analysis, bayesian networks, and network analysis, mediation, moderation, latent variable models, including principal components analysis and ‘factor analysis’, measurement models, structural equation models, mixture models, growth curves, item response theory, Bayesian nonparametric techniques, latent dirichlet allocation, and more.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Graphical and Latent Variable Modeling" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/sem/" />
  <meta property="og:image" content="https://m-clark.github.io/sem/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document focuses on structural equation modeling. It is conceptually based, and tries to generalize beyond the standard SEM treatment. It includes special emphasis on the lavaan package. Topics include: graphical models, including path analysis, bayesian networks, and network analysis, mediation, moderation, latent variable models, including principal components analysis and ‘factor analysis’, measurement models, structural equation models, mixture models, growth curves, item response theory, Bayesian nonparametric techniques, latent dirichlet allocation, and more." />
  <meta name="github-repo" content="m-clark/sem/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Graphical and Latent Variable Modeling" />
  
  <meta name="twitter:description" content="This document focuses on structural equation modeling. It is conceptually based, and tries to generalize beyond the standard SEM treatment. It includes special emphasis on the lavaan package. Topics include: graphical models, including path analysis, bayesian networks, and network analysis, mediation, moderation, latent variable models, including principal components analysis and ‘factor analysis’, measurement models, structural equation models, mixture models, growth curves, item response theory, Bayesian nonparametric techniques, latent dirichlet allocation, and more." />
  <meta name="twitter:image" content="https://m-clark.github.io/sem/img/nineteeneightyR.png" />



<meta name="date" content="2018-07-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="introduction.html">
<link rel="next" href="graphical-models-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>
<script src="libs/d3-3.5.3/./d3.min.js"></script>
<link href="libs/d3heatmapcore-0.0.0/heatmapcore.css" rel="stylesheet" />
<script src="libs/d3heatmapcore-0.0.0/heatmapcore.js"></script>
<script src="libs/d3-tip-0.6.6/index.js"></script>
<script src="libs/d3heatmap-binding-0.6.1.2/d3heatmap.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.4/visNetwork.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.4/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
<link rel="stylesheet" href="css/sem.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="https://m-clark.github.io/sem/">Structural Equation Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> </a></li>
<li class="chapter" data-level="2" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>2</b> Preface</a><ul>
<li class="chapter" data-level="2.1" data-path="preface.html"><a href="preface.html#prerequisites"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="2.1.1" data-path="preface.html"><a href="preface.html#statistical"><i class="fa fa-check"></i><b>2.1.1</b> Statistical</a></li>
<li class="chapter" data-level="2.1.2" data-path="preface.html"><a href="preface.html#programming"><i class="fa fa-check"></i><b>2.1.2</b> Programming</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction.html"><a href="introduction.html#outline"><i class="fa fa-check"></i><b>3.1</b> Outline</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduction.html"><a href="introduction.html#graphical-models"><i class="fa fa-check"></i><b>3.1.1</b> Graphical Models</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction.html"><a href="introduction.html#latent-variables"><i class="fa fa-check"></i><b>3.1.2</b> Latent Variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction.html"><a href="introduction.html#sem"><i class="fa fa-check"></i><b>3.1.3</b> SEM</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction.html"><a href="introduction.html#others"><i class="fa fa-check"></i><b>3.1.4</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction.html"><a href="introduction.html#programming-language-choice"><i class="fa fa-check"></i><b>3.2</b> Programming Language Choice</a></li>
<li class="chapter" data-level="3.3" data-path="introduction.html"><a href="introduction.html#setup"><i class="fa fa-check"></i><b>3.3</b> Setup</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>4</b> Introduction to R</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started"><i class="fa fa-check"></i><b>4.1</b> Getting Started</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installation"><i class="fa fa-check"></i><b>4.1.1</b> Installation</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#packages"><i class="fa fa-check"></i><b>4.1.2</b> Packages</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rstudio"><i class="fa fa-check"></i><b>4.1.3</b> RStudio</a></li>
<li class="chapter" data-level="4.1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-data"><i class="fa fa-check"></i><b>4.1.4</b> Importing Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#key-things-to-know-about-r"><i class="fa fa-check"></i><b>4.2</b> Key things to know about R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-is-a-programming-language-not-a-stats-package"><i class="fa fa-check"></i><b>4.2.1</b> R is a programming language, not a ‘stats package’</a></li>
<li class="chapter" data-level="4.2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#never-ask-if-r-can-do-what-you-want.-it-can."><i class="fa fa-check"></i><b>4.2.2</b> Never ask if R can do what you want. It can.</a></li>
<li class="chapter" data-level="4.2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#main-components-script-console-graphics-device"><i class="fa fa-check"></i><b>4.2.3</b> Main components: script, console, graphics device</a></li>
<li class="chapter" data-level="4.2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-is-easy-to-use-but-difficult-to-master."><i class="fa fa-check"></i><b>4.2.4</b> R is easy to use, but difficult to master.</a></li>
<li class="chapter" data-level="4.2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#object-oriented"><i class="fa fa-check"></i><b>4.2.5</b> Object-oriented</a></li>
<li class="chapter" data-level="4.2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#case-sensitive"><i class="fa fa-check"></i><b>4.2.6</b> Case sensitive</a></li>
<li class="chapter" data-level="4.2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-lavaan-package"><i class="fa fa-check"></i><b>4.2.7</b> The lavaan package</a></li>
<li class="chapter" data-level="4.2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-help"><i class="fa fa-check"></i><b>4.2.8</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#moving-forward"><i class="fa fa-check"></i><b>4.3</b> Moving forward</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises"><i class="fa fa-check"></i><b>4.3.1</b> Exercises</a></li>
<li class="chapter" data-level="4.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#summary"><i class="fa fa-check"></i><b>4.3.2</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphical-models-1.html"><a href="graphical-models-1.html"><i class="fa fa-check"></i><b>5</b> Graphical Models</a><ul>
<li class="chapter" data-level="5.1" data-path="graphical-models-1.html"><a href="graphical-models-1.html#directed-graphs"><i class="fa fa-check"></i><b>5.1</b> Directed Graphs</a><ul>
<li class="chapter" data-level="5.1.1" data-path="graphical-models-1.html"><a href="graphical-models-1.html#standard-linear-model"><i class="fa fa-check"></i><b>5.1.1</b> Standard linear model</a></li>
<li class="chapter" data-level="5.1.2" data-path="graphical-models-1.html"><a href="graphical-models-1.html#path-analysis"><i class="fa fa-check"></i><b>5.1.2</b> Path Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="graphical-models-1.html"><a href="graphical-models-1.html#bayesian-networks"><i class="fa fa-check"></i><b>5.2</b> Bayesian Networks</a></li>
<li class="chapter" data-level="5.3" data-path="graphical-models-1.html"><a href="graphical-models-1.html#undirected-graphs"><i class="fa fa-check"></i><b>5.3</b> Undirected Graphs</a><ul>
<li class="chapter" data-level="5.3.1" data-path="graphical-models-1.html"><a href="graphical-models-1.html#network-analysis"><i class="fa fa-check"></i><b>5.3.1</b> Network analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="graphical-models-1.html"><a href="graphical-models-1.html#summary-1"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
<li class="chapter" data-level="5.5" data-path="graphical-models-1.html"><a href="graphical-models-1.html#r-packages-used"><i class="fa fa-check"></i><b>5.5</b> R packages used</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="latent-variables-1.html"><a href="latent-variables-1.html"><i class="fa fa-check"></i><b>6</b> Latent Variables</a><ul>
<li class="chapter" data-level="6.1" data-path="latent-variables-1.html"><a href="latent-variables-1.html#dimension-reductioncompression"><i class="fa fa-check"></i><b>6.1</b> Dimension Reduction/Compression</a><ul>
<li class="chapter" data-level="6.1.1" data-path="latent-variables-1.html"><a href="latent-variables-1.html#principal-components-analysis"><i class="fa fa-check"></i><b>6.1.1</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="6.1.2" data-path="latent-variables-1.html"><a href="latent-variables-1.html#factor-analysis"><i class="fa fa-check"></i><b>6.1.2</b> Factor Analysis</a></li>
<li class="chapter" data-level="6.1.3" data-path="latent-variables-1.html"><a href="latent-variables-1.html#other-techniques"><i class="fa fa-check"></i><b>6.1.3</b> Other Techniques</a></li>
<li class="chapter" data-level="6.1.4" data-path="latent-variables-1.html"><a href="latent-variables-1.html#summary-2"><i class="fa fa-check"></i><b>6.1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="latent-variables-1.html"><a href="latent-variables-1.html#constructs-and-measurement-models"><i class="fa fa-check"></i><b>6.2</b> Constructs and Measurement Models</a></li>
<li class="chapter" data-level="6.3" data-path="latent-variables-1.html"><a href="latent-variables-1.html#other-issues-in-factor-analysis"><i class="fa fa-check"></i><b>6.3</b> Other issues in Factor Analysis</a><ul>
<li class="chapter" data-level="6.3.1" data-path="latent-variables-1.html"><a href="latent-variables-1.html#some-specific-factor-models-in-sem"><i class="fa fa-check"></i><b>6.3.1</b> Some specific factor models in SEM</a></li>
<li class="chapter" data-level="6.3.2" data-path="latent-variables-1.html"><a href="latent-variables-1.html#scale-development"><i class="fa fa-check"></i><b>6.3.2</b> Scale development</a></li>
<li class="chapter" data-level="6.3.3" data-path="latent-variables-1.html"><a href="latent-variables-1.html#factor-scores"><i class="fa fa-check"></i><b>6.3.3</b> Factor Scores</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="latent-variables-1.html"><a href="latent-variables-1.html#terminology"><i class="fa fa-check"></i><b>6.4</b> Terminology</a></li>
<li class="chapter" data-level="6.5" data-path="latent-variables-1.html"><a href="latent-variables-1.html#some-other-uses-of-latent-variables"><i class="fa fa-check"></i><b>6.5</b> Some Other Uses of Latent Variables</a></li>
<li class="chapter" data-level="6.6" data-path="latent-variables-1.html"><a href="latent-variables-1.html#summary-3"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="latent-variables-1.html"><a href="latent-variables-1.html#r-packages-used-1"><i class="fa fa-check"></i><b>6.7</b> R packages used</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html"><i class="fa fa-check"></i><b>7</b> Latent Growth Curves</a><ul>
<li class="chapter" data-level="7.1" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#random-effects"><i class="fa fa-check"></i><b>7.1</b> Random effects</a><ul>
<li class="chapter" data-level="7.1.1" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#model-formality"><i class="fa fa-check"></i><b>7.1.1</b> Model formality</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#random-effects-in-sem"><i class="fa fa-check"></i><b>7.2</b> Random Effects in SEM</a></li>
<li class="chapter" data-level="7.3" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#simulating-random-effects"><i class="fa fa-check"></i><b>7.3</b> Simulating Random Effects</a></li>
<li class="chapter" data-level="7.4" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#running-a-growth-curve-model"><i class="fa fa-check"></i><b>7.4</b> Running a Growth Curve Model</a></li>
<li class="chapter" data-level="7.5" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#thinking-more-generally-about-regression"><i class="fa fa-check"></i><b>7.5</b> Thinking more generally about regression</a></li>
<li class="chapter" data-level="7.6" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#more-on-lgc"><i class="fa fa-check"></i><b>7.6</b> More on LGC</a><ul>
<li class="chapter" data-level="7.6.1" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#lgc-are-non-standard-sem"><i class="fa fa-check"></i><b>7.6.1</b> LGC are non-standard SEM</a></li>
<li class="chapter" data-level="7.6.2" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#residual-correlations"><i class="fa fa-check"></i><b>7.6.2</b> Residual correlations</a></li>
<li class="chapter" data-level="7.6.3" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#nonlinear-time-effect"><i class="fa fa-check"></i><b>7.6.3</b> Nonlinear time effect</a></li>
<li class="chapter" data-level="7.6.4" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#growth-mixture-models"><i class="fa fa-check"></i><b>7.6.4</b> Growth Mixture Models</a></li>
<li class="chapter" data-level="7.6.5" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#other-covariates"><i class="fa fa-check"></i><b>7.6.5</b> Other covariates</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#some-differences-between-mixed-models-and-growth-curves"><i class="fa fa-check"></i><b>7.7</b> Some Differences between Mixed Models and Growth Curves</a><ul>
<li class="chapter" data-level="7.7.1" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#random-slopes"><i class="fa fa-check"></i><b>7.7.1</b> Random slopes</a></li>
<li class="chapter" data-level="7.7.2" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#wide-vs.long"><i class="fa fa-check"></i><b>7.7.2</b> Wide vs. long</a></li>
<li class="chapter" data-level="7.7.3" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#sample-size"><i class="fa fa-check"></i><b>7.7.3</b> Sample size</a></li>
<li class="chapter" data-level="7.7.4" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#number-of-time-points"><i class="fa fa-check"></i><b>7.7.4</b> Number of time points</a></li>
<li class="chapter" data-level="7.7.5" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#balance"><i class="fa fa-check"></i><b>7.7.5</b> Balance</a></li>
<li class="chapter" data-level="7.7.6" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#numbering-the-time-points"><i class="fa fa-check"></i><b>7.7.6</b> Numbering the time points</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#other-stuff"><i class="fa fa-check"></i><b>7.8</b> Other stuff</a><ul>
<li class="chapter" data-level="7.8.1" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#parallel-processes"><i class="fa fa-check"></i><b>7.8.1</b> Parallel Processes</a></li>
<li class="chapter" data-level="7.8.2" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#cross-lagged-models"><i class="fa fa-check"></i><b>7.8.2</b> Cross-lagged Models</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#summary-4"><i class="fa fa-check"></i><b>7.9</b> Summary</a></li>
<li class="chapter" data-level="7.10" data-path="latent-growth-curves.html"><a href="latent-growth-curves.html#r-packages-used-2"><i class="fa fa-check"></i><b>7.10</b> R Packages Used</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>8</b> Mixture Models</a><ul>
<li class="chapter" data-level="8.1" data-path="mixture-models.html"><a href="mixture-models.html#a-motivating-example"><i class="fa fa-check"></i><b>8.1</b> A Motivating Example</a></li>
<li class="chapter" data-level="8.2" data-path="mixture-models.html"><a href="mixture-models.html#create-clustered-data"><i class="fa fa-check"></i><b>8.2</b> Create Clustered Data</a></li>
<li class="chapter" data-level="8.3" data-path="mixture-models.html"><a href="mixture-models.html#mixture-modeling-with-old-faithful"><i class="fa fa-check"></i><b>8.3</b> Mixture modeling with Old Faithful</a></li>
<li class="chapter" data-level="8.4" data-path="mixture-models.html"><a href="mixture-models.html#sem-and-latent-categorical-variables"><i class="fa fa-check"></i><b>8.4</b> SEM and Latent Categorical Variables</a><ul>
<li class="chapter" data-level="8.4.1" data-path="mixture-models.html"><a href="mixture-models.html#latent-categories-vs.multi-group-analysis"><i class="fa fa-check"></i><b>8.4.1</b> Latent Categories vs. Multi-group Analysis</a></li>
<li class="chapter" data-level="8.4.2" data-path="mixture-models.html"><a href="mixture-models.html#latent-trajectories"><i class="fa fa-check"></i><b>8.4.2</b> Latent Trajectories</a></li>
<li class="chapter" data-level="8.4.3" data-path="mixture-models.html"><a href="mixture-models.html#estimation"><i class="fa fa-check"></i><b>8.4.3</b> Estimation</a></li>
<li class="chapter" data-level="8.4.4" data-path="mixture-models.html"><a href="mixture-models.html#terminology-in-sem"><i class="fa fa-check"></i><b>8.4.4</b> Terminology in SEM</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mixture-models.html"><a href="mixture-models.html#summary-5"><i class="fa fa-check"></i><b>8.5</b> Summary</a></li>
<li class="chapter" data-level="8.6" data-path="mixture-models.html"><a href="mixture-models.html#r-packages-used-3"><i class="fa fa-check"></i><b>8.6</b> R Packages Used</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="item-response-theory.html"><a href="item-response-theory.html"><i class="fa fa-check"></i><b>9</b> Item Response Theory</a><ul>
<li class="chapter" data-level="9.1" data-path="item-response-theory.html"><a href="item-response-theory.html#standard-models"><i class="fa fa-check"></i><b>9.1</b> Standard Models</a><ul>
<li class="chapter" data-level="9.1.1" data-path="item-response-theory.html"><a href="item-response-theory.html#one-parameter-model"><i class="fa fa-check"></i><b>9.1.1</b> One Parameter Model</a></li>
<li class="chapter" data-level="9.1.2" data-path="item-response-theory.html"><a href="item-response-theory.html#two-parameter-model"><i class="fa fa-check"></i><b>9.1.2</b> Two Parameter Model</a></li>
<li class="chapter" data-level="9.1.3" data-path="item-response-theory.html"><a href="item-response-theory.html#three-parameter-model"><i class="fa fa-check"></i><b>9.1.3</b> Three Parameter Model</a></li>
<li class="chapter" data-level="9.1.4" data-path="item-response-theory.html"><a href="item-response-theory.html#four-parameter-model"><i class="fa fa-check"></i><b>9.1.4</b> Four Parameter Model</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="item-response-theory.html"><a href="item-response-theory.html#other-irt-models"><i class="fa fa-check"></i><b>9.2</b> Other IRT Models</a><ul>
<li class="chapter" data-level="9.2.1" data-path="item-response-theory.html"><a href="item-response-theory.html#additional-covariates"><i class="fa fa-check"></i><b>9.2.1</b> Additional covariates</a></li>
<li class="chapter" data-level="9.2.2" data-path="item-response-theory.html"><a href="item-response-theory.html#graded-response-model"><i class="fa fa-check"></i><b>9.2.2</b> Graded Response Model</a></li>
<li class="chapter" data-level="9.2.3" data-path="item-response-theory.html"><a href="item-response-theory.html#multidimensional-irt"><i class="fa fa-check"></i><b>9.2.3</b> Multidimensional IRT</a></li>
<li class="chapter" data-level="9.2.4" data-path="item-response-theory.html"><a href="item-response-theory.html#other-irt"><i class="fa fa-check"></i><b>9.2.4</b> Other IRT</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="item-response-theory.html"><a href="item-response-theory.html#summary-6"><i class="fa fa-check"></i><b>9.3</b> Summary</a></li>
<li class="chapter" data-level="9.4" data-path="item-response-theory.html"><a href="item-response-theory.html#irt-terminology"><i class="fa fa-check"></i><b>9.4</b> IRT Terminology</a></li>
<li class="chapter" data-level="9.5" data-path="item-response-theory.html"><a href="item-response-theory.html#r-packages-used-4"><i class="fa fa-check"></i><b>9.5</b> R Packages Used</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="topic-models.html"><a href="topic-models.html"><i class="fa fa-check"></i><b>10</b> Topic Models</a><ul>
<li class="chapter" data-level="10.1" data-path="topic-models.html"><a href="topic-models.html#latent-dirichlet-allocation"><i class="fa fa-check"></i><b>10.1</b> Latent Dirichlet Allocation</a></li>
<li class="chapter" data-level="10.2" data-path="topic-models.html"><a href="topic-models.html#analysis"><i class="fa fa-check"></i><b>10.2</b> Analysis</a></li>
<li class="chapter" data-level="10.3" data-path="topic-models.html"><a href="topic-models.html#summary-of-topic-models"><i class="fa fa-check"></i><b>10.3</b> Summary of Topic Models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-nonparametric-models.html"><a href="bayesian-nonparametric-models.html"><i class="fa fa-check"></i><b>11</b> Bayesian Nonparametric Models</a><ul>
<li class="chapter" data-level="11.1" data-path="bayesian-nonparametric-models.html"><a href="bayesian-nonparametric-models.html#chinese-restaurant-process"><i class="fa fa-check"></i><b>11.1</b> Chinese Restaurant Process</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian-nonparametric-models.html"><a href="bayesian-nonparametric-models.html#indian-buffet-process"><i class="fa fa-check"></i><b>11.2</b> Indian Buffet Process</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-nonparametric-models.html"><a href="bayesian-nonparametric-models.html#summary-7"><i class="fa fa-check"></i><b>11.3</b> Summary</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-nonparametric-models.html"><a href="bayesian-nonparametric-models.html#r-packages-used-5"><i class="fa fa-check"></i><b>11.4</b> R packages used</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="other-techniques-1.html"><a href="other-techniques-1.html"><i class="fa fa-check"></i><b>12</b> Other Techniques</a><ul>
<li class="chapter" data-level="12.1" data-path="other-techniques-1.html"><a href="other-techniques-1.html#recommender-systems"><i class="fa fa-check"></i><b>12.1</b> Recommender Systems</a></li>
<li class="chapter" data-level="12.2" data-path="other-techniques-1.html"><a href="other-techniques-1.html#hidden-markov-models"><i class="fa fa-check"></i><b>12.2</b> Hidden Markov Models</a></li>
<li class="chapter" data-level="12.3" data-path="other-techniques-1.html"><a href="other-techniques-1.html#cluster-analysis"><i class="fa fa-check"></i><b>12.3</b> “Cluster analysis”</a><ul>
<li class="chapter" data-level="12.3.1" data-path="other-techniques-1.html"><a href="other-techniques-1.html#k-means"><i class="fa fa-check"></i><b>12.3.1</b> K-means</a></li>
<li class="chapter" data-level="12.3.2" data-path="other-techniques-1.html"><a href="other-techniques-1.html#hierarchical"><i class="fa fa-check"></i><b>12.3.2</b> Hierarchical</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="other-techniques-1.html"><a href="other-techniques-1.html#ica"><i class="fa fa-check"></i><b>12.4</b> ICA</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>13</b> </a></li>
<li class="chapter" data-level="14" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>14</b> Appendix</a><ul>
<li class="chapter" data-level="14.1" data-path="appendix.html"><a href="appendix.html#data-set-descriptions"><i class="fa fa-check"></i><b>14.1</b> Data Set Descriptions</a><ul>
<li class="chapter" data-level="14.1.1" data-path="appendix.html"><a href="appendix.html#mcclelland"><i class="fa fa-check"></i><b>14.1.1</b> McClelland</a></li>
<li class="chapter" data-level="14.1.2" data-path="appendix.html"><a href="appendix.html#national-longitudinal-survey-of-youth-1997-nlsy97"><i class="fa fa-check"></i><b>14.1.2</b> National Longitudinal Survey of Youth (1997, NLSY97)</a></li>
<li class="chapter" data-level="14.1.3" data-path="appendix.html"><a href="appendix.html#wheaton-1977-data"><i class="fa fa-check"></i><b>14.1.3</b> Wheaton 1977 data</a></li>
<li class="chapter" data-level="14.1.4" data-path="appendix.html"><a href="appendix.html#harman-5"><i class="fa fa-check"></i><b>14.1.4</b> Harman 5</a></li>
<li class="chapter" data-level="14.1.5" data-path="appendix.html"><a href="appendix.html#big-five"><i class="fa fa-check"></i><b>14.1.5</b> Big Five</a></li>
<li class="chapter" data-level="14.1.6" data-path="appendix.html"><a href="appendix.html#old-faithful"><i class="fa fa-check"></i><b>14.1.6</b> Old Faithful</a></li>
<li class="chapter" data-level="14.1.7" data-path="appendix.html"><a href="appendix.html#harman-1974"><i class="fa fa-check"></i><b>14.1.7</b> Harman 1974</a></li>
<li class="chapter" data-level="14.1.8" data-path="appendix.html"><a href="appendix.html#marsh-hocevar-1985"><i class="fa fa-check"></i><b>14.1.8</b> Marsh &amp; Hocevar 1985</a></li>
<li class="chapter" data-level="14.1.9" data-path="appendix.html"><a href="appendix.html#abortion-attitudes"><i class="fa fa-check"></i><b>14.1.9</b> Abortion Attitudes</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix.html"><a href="appendix.html#terminology-in-sem-1"><i class="fa fa-check"></i><b>14.2</b> Terminology in SEM</a><ul>
<li class="chapter" data-level="14.2.1" data-path="appendix.html"><a href="appendix.html#problematic-andor-not-very-useful-terms"><i class="fa fa-check"></i><b>14.2.1</b> Problematic and/or not very useful terms</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="appendix.html"><a href="appendix.html#lavaan-output-explained"><i class="fa fa-check"></i><b>14.3</b> Lavaan Output Explained</a></li>
<li class="chapter" data-level="14.4" data-path="appendix.html"><a href="appendix.html#code-examples"><i class="fa fa-check"></i><b>14.4</b> Code Examples</a><ul>
<li class="chapter" data-level="14.4.1" data-path="appendix.html"><a href="appendix.html#factor-analysis-via-maximum-likelihood"><i class="fa fa-check"></i><b>14.4.1</b> Factor Analysis via Maximum Likelihood</a></li>
<li class="chapter" data-level="14.4.2" data-path="appendix.html"><a href="appendix.html#parallel-process-example"><i class="fa fa-check"></i><b>14.4.2</b> Parallel Process Example</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="appendix.html"><a href="appendix.html#causal-bias"><i class="fa fa-check"></i><b>14.5</b> Causal Bias</a><ul>
<li class="chapter" data-level="14.5.1" data-path="appendix.html"><a href="appendix.html#prediction"><i class="fa fa-check"></i><b>14.5.1</b> Prediction</a></li>
<li class="chapter" data-level="14.5.2" data-path="appendix.html"><a href="appendix.html#chance"><i class="fa fa-check"></i><b>14.5.2</b> Chance</a></li>
<li class="chapter" data-level="14.5.3" data-path="appendix.html"><a href="appendix.html#other"><i class="fa fa-check"></i><b>14.5.3</b> Other</a></li>
<li class="chapter" data-level="14.5.4" data-path="appendix.html"><a href="appendix.html#some-references"><i class="fa fa-check"></i><b>14.5.4</b> Some references</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="appendix.html"><a href="appendix.html#software-revisited"><i class="fa fa-check"></i><b>14.6</b> Software Revisited</a><ul>
<li class="chapter" data-level="14.6.1" data-path="appendix.html"><a href="appendix.html#mplus"><i class="fa fa-check"></i><b>14.6.1</b> Mplus</a></li>
<li class="chapter" data-level="14.6.2" data-path="appendix.html"><a href="appendix.html#r"><i class="fa fa-check"></i><b>14.6.2</b> R</a></li>
<li class="chapter" data-level="14.6.3" data-path="appendix.html"><a href="appendix.html#stata"><i class="fa fa-check"></i><b>14.6.3</b> Stata</a></li>
<li class="chapter" data-level="14.6.4" data-path="appendix.html"><a href="appendix.html#other-2"><i class="fa fa-check"></i><b>14.6.4</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="appendix.html"><a href="appendix.html#resources"><i class="fa fa-check"></i><b>14.7</b> Resources</a><ul>
<li class="chapter" data-level="14.7.1" data-path="appendix.html"><a href="appendix.html#graphical-models-2"><i class="fa fa-check"></i><b>14.7.1</b> Graphical Models</a></li>
<li class="chapter" data-level="14.7.2" data-path="appendix.html"><a href="appendix.html#potential-outcomes"><i class="fa fa-check"></i><b>14.7.2</b> Potential Outcomes</a></li>
<li class="chapter" data-level="14.7.3" data-path="appendix.html"><a href="appendix.html#measurement-models-including-irt"><i class="fa fa-check"></i><b>14.7.3</b> Measurement Models (including IRT)</a></li>
<li class="chapter" data-level="14.7.4" data-path="appendix.html"><a href="appendix.html#applied-sem"><i class="fa fa-check"></i><b>14.7.4</b> Applied SEM</a></li>
<li class="chapter" data-level="14.7.5" data-path="appendix.html"><a href="appendix.html#nonparametric-models"><i class="fa fa-check"></i><b>14.7.5</b> Nonparametric models</a></li>
<li class="chapter" data-level="14.7.6" data-path="appendix.html"><a href="appendix.html#lavaan"><i class="fa fa-check"></i><b>14.7.6</b> lavaan</a></li>
<li class="chapter" data-level="14.7.7" data-path="appendix.html"><a href="appendix.html#other-sem-tools-in-r"><i class="fa fa-check"></i><b>14.7.7</b> Other SEM tools in R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'><a href="https://m-clark.github.io/"><img src="img/mc.png" style="width:50%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo"></a></li>
<li class='after'><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width:50%; border-width:0; display:block; margin: 0 auto;" src="img/ccbysa_test.png"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="font-size:150%; font-variant:small-caps; font-style:italic; ">Graphical and Latent Variable Modeling</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-r" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Introduction to R</h1>
<p>This introduction to R is very brief and only geared toward providing some basics so that one can understand and run the code associated with the content. It is geared toward an audience that likely has no programming experience whatsoever, but may have had some exposure to traditional statistics packages. If you have some basic familiarity with R you may skip this chapter, though it might serve as a refresher for some.</p>
<div id="getting-started" class="section level2">
<h2><span class="header-section-number">4.1</span> Getting Started</h2>
<div id="installation" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Installation</h3>
<p>As mentioned previously, to begin with R for your own machine, you just need to go to the <a href="https://www.r-project.org/">R website</a>, download it for your operating system, and install. Then go to <a href="https://www.rstudio.com/">RStudio</a>, download and install it. From there on you only need RStudio to use R.</p>
<p>Updates occur every few months, and you should update R whenever a new version is released.</p>
</div>
<div id="packages" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Packages</h3>
<p>As soon as you install it, R is already the most powerful statistical environment within which to work. However, its real strength comes from the community, which has added thousands of <span class="emph">packages</span> that provide additional or enhanced functionality. You will regularly find packages that specifically do something you want, and will need to install them in order to use them.</p>
<p>RStudio provides a <strong>Packages</strong> tab, but it is usually just as or more efficient to use the <span class="func">install.packages</span> function.</p>
<p><img src="img/packagesTab.png" style="display:block; margin: 0 auto;"></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&#39;mynewfavorite&#39;</span>)</a></code></pre></div>
<p>At this point there are over 7000 packages available through standard sources, and many more through unofficial ones. To start getting some ideas of what you want to use, you will want to spend time at places like <a href="https://cran.r-project.org/web/views/">CRAN Task Views</a>, <a href="http://www.rdocumentation.org/">Rdocumentation</a>, or with a list <a href="https://github.com/qinwf/awesome-R">like this one</a>.</p>
<p>The main thing to note is that if you want to use a package, you have to load it with the <span class="func">library</span> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(lazerhawk)</a></code></pre></div>
<p>Sometimes, you only need the package for one thing and there is no reason to keep it loaded, in which case you can use the following approach.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">packagename<span class="op">::</span><span class="kw">packagefunction</span>(args)</a></code></pre></div>
<p>I suggest using the <span class="func">library</span> function for newbies.</p>
<p>You’ll get the hang of finding, installing, and using packages quite quickly. However, note that the increasing popularity and ease of using R means that packages can vary quite a bit in terms of quality, so you may need to try out a couple packages with seemingly similar functionality to find the best for your situation.</p>
</div>
<div id="rstudio" class="section level3">
<h3><span class="header-section-number">4.1.3</span> RStudio</h3>
<p>RStudio is an <span class="emph">integrated development environment</span> (<strong>IDE</strong>) specifically geared toward R (though it works for other languages too). At the very least it will make your programming far easier and more efficient, at best you can create publish-ready documents, manage projects, create interactive website regarding your research, use version control, and much more. I have an overview <a href="https://m-clark.github.io/workshops/introRstudio.html">here</a>.</p>
<p>See <a href="http://ess.r-project.org/">Emacs Speaks Statistics</a> for an alternative. The point is, base R is not an efficient way to use R, and you have at least two very powerful options to make your coding experience easier and more efficient.</p>
</div>
<div id="importing-data" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Importing Data</h3>
<p>It is as easy to import data into R from other programs and text files as it is any other statistical program. As a first step, feel free to use the menu-based approach via the Environment tab.</p>
<p><img src="img/importData.png" style="display:block; margin: 0 auto;"></p>
<p>Note that you have easy access to the code that actually does the job. You should quickly get used to a code-based approach as soon as possible, that way you don’t waste time clicking and hunting for files, and instead can quickly run a single line of code. It is easier to select specific options as well. Some key packages to note:</p>
<ul>
<li><span class="pack">base</span>: Base R already can read in tab-delimited, comma-separated etc. text files</li>
<li><span class="pack">foreign</span>: Base R comes with the foreign package that can read in files from other statistical packages. However support for Stata ended with version 12.</li>
</ul>
<p>Newer packages</p>
<ul>
<li><span class="pack">readr</span>: enhanced versions of Base R read functionality</li>
<li><span class="pack">haven</span>: replacement for foreign that can also read current Stata files</li>
<li><span class="pack">readxl</span>: for Excel specifically</li>
</ul>
<p>There are many other packages that would be of use for special situations and other less common file types and structures.</p>
</div>
</div>
<div id="key-things-to-know-about-r" class="section level2">
<h2><span class="header-section-number">4.2</span> Key things to know about R</h2>
<div id="r-is-a-programming-language-not-a-stats-package" class="section level3">
<h3><span class="header-section-number">4.2.1</span> R is a programming language, not a ‘stats package’</h3>
<p>The first thing to note for those new to R is that R is a language that is oriented toward, but not specific to, dealing with statistics. This means it’s highly flexible, but does take some getting used to. If you go in with a spreadsheet style mindset, you’ll have difficulty, as well as miss out on the power it has to offer.</p>
</div>
<div id="never-ask-if-r-can-do-what-you-want.-it-can." class="section level3">
<h3><span class="header-section-number">4.2.2</span> Never ask if R can do what you want. It can.</h3>
<p>The only limitation to R is the user’s programming sophistication. The better you get at statistical programming the further you can explore your data and take your research. This holds for any statistical endeavor whether using R or not.</p>
</div>
<div id="main-components-script-console-graphics-device" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Main components: script, console, graphics device</h3>
<p>With R, the <em>script</em> is where you write your R code. While you could do everything at the console, this would be difficult at best and unreproducible. The <em>console</em> is where the results are produced from running the script. Again you can do one-liner stuff there, such as getting help for a function. The <em>graphics device</em> is where visualizations are produced, and in RStudio you have two, one for static plots, and a <strong>viewer</strong> for potentially interactive ones.</p>
</div>
<div id="r-is-easy-to-use-but-difficult-to-master." class="section level3">
<h3><span class="header-section-number">4.2.4</span> R is easy to use, but difficult to master.</h3>
<p>If you only want to use R in an applied fashion, as we will do here, R can be very easy to use. As an example the following code would read in data and run a standard linear regression with the <span class="func">lm</span> (i.e. linear model) function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mydata =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&#39;location/myfile.csv&#39;</span>)   <span class="co"># some file with an &#39;x&#39; and &#39;y&#39; variable</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">regModel =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data=</span>mydata)               <span class="co"># standard regression</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">summary</span>(regModel)                               <span class="co"># summary of results</span></a></code></pre></div>
<p>The above code demonstrates that R can be as easy to use as anything else, and in my opinion, it is for any standard analysis. In addition, the formula syntax is utilized the vast majority of modeling packages (including <span class="pack">lavaan</span>), as is the <span class="func">summary</span> function for printing model results. The nice part is that R can still be <em>easier</em> to use with more complex analyses you either won’t find elsewhere or will only get with crippled functionality.</p>
</div>
<div id="object-oriented" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Object-oriented</h3>
<p>This section may be a little more than a newcomer to R wants or even needs to know to get started with R. However, most of the newbie’s errors will be due not knowing a little about this aspect of R programming, and I’ve seen some make the same mistakes even after using R for a long time as a result.</p>
<p>R is <span class="emph">object-oriented</span>. For our purposes this means that we create what are called objects and use <span class="emph">functions</span> to manipulate those objects in some fashion. In the above code we created two objects, an object that held the data and an object that held the regression results.</p>
<p>Objects can be <strong><em>anything</em></strong>, a character string, a list of 1000 data sets, the results of an analysis, <strong><em>anything</em></strong>.</p>
<div id="assignment" class="section level4">
<h4><span class="header-section-number">4.2.5.1</span> Assignment</h4>
<p>In order to create an object, we must <span class="emph">assign</span> something to it. You’ll come across two ways to do this.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">myObject =<span class="st"> </span>something</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">myObject &lt;-<span class="st"> </span>something</a></code></pre></div>
<p>These result in the same thing, an object called <span class="objclass">myObject</span> that contains ‘something’ in it. For all appropriate practical use, whether you use <code>=</code> or <code>&lt;-</code>is a matter of personal preference. The point is that typical practice in R entails that one assigns something to an object and then uses functions on that object to get something more from it.</p>
</div>
<div id="functions" class="section level4">
<h4><span class="header-section-number">4.2.5.2</span> Functions</h4>
<p>Functions are objects that take input of various kinds and produce some output (simply called a <em>value</em>). In the above code we used three functions: <span class="func">read.csv</span>, <span class="func">lm</span>, and <span class="func">summary</span>. Functions (usually) come with named <span class="emph">arguments</span>, that note what types of inputs the function can take. With <span class="func">read.csv</span>, we merely gave it one argument, the file name, but there are actually a couple dozen, each with some default. Type <code>?read.csv</code> at the console to see the help file.</p>
</div>
<div id="classes" class="section level4">
<h4><span class="header-section-number">4.2.5.3</span> Classes</h4>
<p>All objects have a certain class, which means that some functions will work in certain ways depending on the class. Consider the following code.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">y =<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">mod =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">summary</span>(x)</a></code></pre></div>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-2.95479 -0.83549  0.08262  0.01596  0.87667  3.21825 </code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">summary</span>(mod)</a></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.23602 -0.58896 -0.03882  0.61420  2.07338 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.02311    0.09309  -0.248    0.804    
x            1.02046    0.08089  12.615   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9308 on 98 degrees of freedom
Multiple R-squared:  0.6189,    Adjusted R-squared:  0.615 
F-statistic: 159.1 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In both cases we used the <code>summary</code> function, but get different results. There are two <span class="emph">methods</span> for summary at work here: <span>summary.default</span> and <span>summary.lm</span>. Which is used depends on the class of the object given as an argument to the summary function. Most of the time however, there are unique functions that will only work on one class of object.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">class</span>(x)</a></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">class</span>(mod)</a></code></pre></div>
<pre><code>[1] &quot;lm&quot;</code></pre>
<p>One of the most common classes of objects used is the <span class="objclass">data.frame</span>. Data frames are matrices that contain multiple types of vectors that are the variables and observations of interest. The contents can be numeric, factors (categorical variables), character strings and other types of objects.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">nams =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Bob Ross&#39;</span>, <span class="st">&#39;Bob Marley&#39;</span>, <span class="st">&#39;Bob Odenkirk&#39;</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">places =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Dirt&#39;</span>, <span class="st">&#39;Dirt&#39;</span>, <span class="st">&#39;New Mexico&#39;</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">yod =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1995</span>, <span class="dv">1981</span>, <span class="dv">2028</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">bobs =<span class="st"> </span><span class="kw">data.frame</span>(nams, places, yod)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">bobs</a></code></pre></div>
<pre><code>          nams     places  yod
1     Bob Ross       Dirt 1995
2   Bob Marley       Dirt 1981
3 Bob Odenkirk New Mexico 2028</code></pre>
</div>
</div>
<div id="case-sensitive" class="section level3">
<h3><span class="header-section-number">4.2.6</span> Case sensitive</h3>
<p>A great deal of the errors you will get when you start learning R will result from not typing something correctly. For example, what if we try <code>summary(X)</code>?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">summary</span>(X)</a></code></pre></div>
<pre><code>Error in summary(X): object &#39;X&#39; not found</code></pre>
<p>Errors are merely messages or calls for help from R. It can’t do what you ask and needs something else in order to perform the task. In this case, R is telling you it can’t find anything called X, which makes sense because the object name is lowercase <span class="math inline">\(x\)</span>. This error message is somewhat straightforward, but error messages for all programming languages typically aren’t, and depending on what you’re trying to do, it may be fairly vague. If you get an error, your first thought as you start out with R should be to check the names of things.</p>
</div>
<div id="the-lavaan-package" class="section level3">
<h3><span class="header-section-number">4.2.7</span> The lavaan package</h3>
<p>You’ll see more later, but in order to use <span class="pack">lavaan</span> for structural equation modeling, you’ll need two things primarily: an object that represents the <strong>data</strong>, and an object that represents the <strong>model</strong>. It will look something like the following.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">modelCode =<span class="st"> &quot;</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  y ~ x1 + x2 + lv            # structural/regression model</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  lv =~ z1 + z2 + z3 + z4     # measurement model with latent variable lv</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw">library</span>(lavaan)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">mymodel =<span class="st"> </span><span class="kw">sem</span>(modelCode, <span class="dt">data=</span>mydata)</a></code></pre></div>
<p>The character string is our model, and it can actually be kept as a separate file (without the assignment) if desired. Using the <span class="pack">lavaan</span> library, we can then use one of its specific functions like <span class="func">cfa</span>, <span class="func">sem</span>, or <span class="func">growth</span> to use the model code object (<span class="objclass">modelCode</span> above) and the data object (<span class="objclass">mydata</span> above).</p>
<p>The way to define things in lavaan can be summarized as follows.</p>
<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
formulaType
</th>
<th style="text-align:center;">
operator
</th>
<th style="text-align:center;">
mnemonic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
latent variable definition
</td>
<td style="text-align:center;">
=~
</td>
<td style="text-align:center;">
is measured by
</td>
</tr>
<tr>
<td style="text-align:center;">
regression
</td>
<td style="text-align:center;">
~
</td>
<td style="text-align:center;">
is regressed on
</td>
</tr>
<tr>
<td style="text-align:center;">
(residual) (co)variance
</td>
<td style="text-align:center;">
~~
</td>
<td style="text-align:center;">
is correlated with
</td>
</tr>
<tr>
<td style="text-align:center;">
intercept
</td>
<td style="text-align:center;">
~ 1
</td>
<td style="text-align:center;">
intercept
</td>
</tr>
<tr>
<td style="text-align:center;">
fixed parameter
</td>
<td style="text-align:center;">
_*
</td>
<td style="text-align:center;">
is fixed at the value of _
</td>
</tr>
<tr>
<td style="text-align:center;">
named parameter
</td>
<td style="text-align:center;">
abc*
</td>
<td style="text-align:center;">
is named abc
</td>
</tr>
</tbody>
</table>
<div id="matching-lavaan-and-r-to-mplus" class="section level5">
<h5><span class="header-section-number">4.2.7.0.1</span> Matching lavaan and R to MPlus</h5>
<p>With <span class="pack">lavaan</span> and related packages there is almost complete overlap with MPlus. However, there are some things to note.</p>
<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:center;">
packages
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
standard CFA, path, SEM, growth
</td>
<td style="text-align:center;">
lavaan
</td>
</tr>
<tr>
<td style="text-align:left;">
missing values
</td>
<td style="text-align:center;">
lavaan (FIML), semTools (MI +)
</td>
</tr>
<tr>
<td style="text-align:left;">
multigroup
</td>
<td style="text-align:center;">
lavaan, semTools
</td>
</tr>
<tr>
<td style="text-align:left;">
mixture models
</td>
<td style="text-align:center;">
flexmix, poLCA, many others
</td>
</tr>
<tr>
<td style="text-align:left;">
Bayesian
</td>
<td style="text-align:center;">
blavaan
</td>
</tr>
<tr>
<td style="text-align:left;">
survey
</td>
<td style="text-align:center;">
lavaan, survey.lavaan
</td>
</tr>
<tr>
<td style="text-align:left;">
multilevel
</td>
<td style="text-align:center;">
lavaan (new), mediation
</td>
</tr>
<tr>
<td style="text-align:left;">
factor score regression
</td>
<td style="text-align:center;">
lavaan
</td>
</tr>
<tr>
<td style="text-align:left;">
visualization
</td>
<td style="text-align:center;">
lavaanPlot
</td>
</tr>
</tbody>
</table>
<p>The one glaring lack <span class="pack">lavaan</span> has regards mixture models, i.e. those with latent categorical variables. However, I’d argue there is far more functionality in R generally, with results that are far more easy to work with than you would have with MPlus. Note that <span class="pack">lavaan</span> handles <em>observed</em> categorical variables just fine, though oddly with only a probit link function (no logit).</p>
<p>Up until version 0.6-1 <span class="pack">lavaan</span> had no support for multilevel models. However, it now can do two-level SEM, and the <span class="pack">mediation</span> package has long been able to do single mediator mixed/multilevel models<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. In addition, <span class="pack">lavaan</span> has added some survey support, but you’ll have plenty with <span class="pack">survey.lavaan</span>.</p>
<p>Latent variable interactions are not conducted automatically in <span class="pack">lavaan</span>. One way to do it is to create a product term for all pairs of items pertaining to two factors, and then specify a latent variable where the manifest variables are the product terms. There is an example provided <a href="https://rpubs.com/njaalf/workshop2014">here</a>, and while the syntax is inefficient, it is conceptually clear.</p>
<p>Unless you have complicated mediation structure (rarely sufficiently justified by SEM practitioners), there is no reason that I can see to do growth curve models. There is far, far more functionality in R for mixed models (e.g. <span class="pack">lme4</span>, <span class="pack">mgcv</span>, <span class="pack">brms</span>), which are the far more common and flexible approach to modeling longitudinal data (and otherwise equivalent). Such models handle nonlinear trends, complicated residual structure, alternative distributions, spatial and phylogenetic correlational structures, and more. MPlus simply doesn’t compete in this realm, and has terribly tedious syntax for either growth curve or multilevel models.</p>
<p>On top of everything else, the <a href="https://m-clark.github.io/R-models/#lavaan-extensions">lavaan ecosystem</a>, i.e. packages that work with and enhance its models, continues to grow. In addition, with R there are utilities for SEM you won’t find with MPlus, such as model search, regularization, and more. And finally, with the <span class="pack">MPlusAutomation</span> package it’s even easier to use MPlus with R than it is to use MPlus itself!</p>
</div>
</div>
<div id="getting-help" class="section level3">
<h3><span class="header-section-number">4.2.8</span> Getting help</h3>
<p>Use <code>?</code> to get the help file for a specific function, or <code>??</code> to do a search, possibly on a quoted phrase.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">?lm</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">??regression</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">??<span class="st">&#39;nonlinear regression&#39;</span></a></code></pre></div>
</div>
</div>
<div id="moving-forward" class="section level2">
<h2><span class="header-section-number">4.3</span> Moving forward</h2>
<p>Hopefully you’ll get the hang of things as we run the code in later chapters. You’ll essentially only be asked to tweak code that’s already provided. This document (and associated workshop) is not the place to learn R. However, here are some exercises to make sure we start to get comfortable with it.</p>
<div id="exercises" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Exercises</h3>
<p>Interactive version <a href="exercises/exercise_introR.nb.html">here</a></p>
<ol style="list-style-type: decimal">
<li><p>Create an object that consists of the numbers one through five.
using <code>c(1,2,3,4,5)</code> or <code>1:5</code></p></li>
<li><p>Create a different object, that is the same as that object, but plus 1 (i.e. the numbers two through six).</p></li>
<li><p>Without creating an object, use <span class="func">cbind</span> and <span class="func">rbind</span>, feeding the objects you just created as arguments. For example <code>cbind(obj1, obj2)</code>.</p></li>
<li><p>Create a new object using <span class="objclass">data.frame</span> just as you did <span class="func">rbind</span> or <span class="func">cbind</span> in #3.</p></li>
<li><p>Inspect the class of the object, and use the <span class="func">summary</span> function on it.</p></li>
</ol>
</div>
<div id="summary" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Summary</h3>
<p>There’s a lot to learn with R, and the more time you spend with R the easier your research process will likely go, and the more you will learn about statistical analysis.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>In practice, these models are problematic even for MPlus.<a href="introduction-to-r.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphical-models-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "san-serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"search": true,
"highlight": "pygments"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
